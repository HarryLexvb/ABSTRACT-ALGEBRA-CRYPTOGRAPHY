#include <iostream>
#include "rsa_bloques.h"
using namespace std;

int main(){
    rsa_bloques yo(1024);
     /*
    ZZ n= conv<ZZ>("21298588461764181952991718538803998469743735884068789529854983154964366681056933395117174619539702130586194370368112091992321682802770507536590645188751813020570732281412913159484873157847071668511007548720768518824333508972300804343305293257199328531865783744857480521513323027412791769041116062853009139038790505371820065795667108213061677539196291439787576139626045786585722901064630581825534001765751739796620691567945013486506927653221479372820027283518474017132672297515801082387381242816563912293923188391123201103722413603311016274800703378021652848931810985211361803106810933988848399847884109613308369758823");
    ZZ e= conv<ZZ>("168413587882830188671789342264439078983483247394114553275649841089727261571210979819494410754534333256903177218326354261993647007394521701505560096757553500407433110865539255715310193257215470722613603732049212805871358540024133820627587660344739871812092542902625903035514050152179603216968613874655507913845");//*/

    //ZZ n= conv<ZZ>("17329205153479757733953585910476246478548391422505727107853224423357040843314611984476387181161287781203521342790682981879513765760910495246643631972643731412895875098634366899843609427828148713091206242321139531682022958476159820482840792503813703975604769020031339808234289496803388153352813135067964151259135488852472876589682436803255198339961623266059750422379553780167634942235416440158987924797737328650825487854936298075070810433344617890666334902629822492409121996006540453884386037322701533914252310902932127920956449032152831450106742964955634822189715845423982913931392919043412449760416075284595113683079	");
    //ZZ e= conv<ZZ>("114249074242817760683473488436589463507341717625756008908553333630094852941819799461955892708833266780908926976338500242415976270555761013532173357386850057561574589440017644017607554843327517106679679630683134291305165841889295926141735386351536969742644948977484171682840300527929388840835894526430783375011");

 //    cout<< "\nFIRMAR Y CIFRAR:\n" << yo.sign_encrypt("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nunc eget purus nec quam varius vestibulum a eu nisi. Nulla facilisi. Fusce tristique bibendum metus vitae ornare. Donec consequat magna vitae orci euismod, ac finibus mi eleifend. Curabitur tempor maximus nibh eget dictum. Integer et mi vel nibh gravida porttitor vitae vel metus. Donec tempus lectus eleifend volutpat aliquet. Vestibulum finibus sapien id felis pulvinar molestie. Donec in neque non sem egestas semper.",n,e);
    //cout<<yo.remove_sign("06675891706576083736889539326120173630876245026029323215187807399290449958684999554969509998864842291173079392438163197310979111460899629528556945941967915438024288946296170566531517424668708503329905618378060575584216341141480841818249484368316147700648280277770866577509734334230210406158276806146969574922730199334943136457542248999631457240694798387993152183462779177484397881630997798407883106519810770112192348841751374511585152360508062958605981890611215395957477841227230347749517340364455528320302484856847500640870201922911755803175222302271870696661612379319181958821682809673916639886383469656238380632624032191664883630799024865760937244113576553054344865230641196765378553737297533493101967261740452003175158527723817507409037791216074536624858813051835865242777173350162290928506367820456240379464305900339707956097555499773581429111541749988807099889194030290959892586029816646900171534725368448523305456441093954235159990206916362573134619381919776925453091227112552681408858516660847747836228010302884344006500110999510269224363350595439556692683839576689115992442805836144976720561369395360063713958662545740845004816713913110686025689040813619884183728051953740077698559248545837103810945986627629180090907118134451034241521306635926791923636988814591954507342871744293898592500887486193305290615441886812913595277605036037425060107735528767590665012620521031913134802413838321678698360346595711419955914836946233100922162202371919301720963225437674056802264129621434847808197683700267052989761370798818487969438845957291600141659818895051274479811194404272815145277463450409537232628242151277968521775805181694364312185725628842003866400931241068686941777684874940478457473727823378629561063681097475653336778243378318679098828327432234913205016892836109880371471553715260822531903227895364174380303734469706200263370018820788020612081457544342264820441430060451440293544058431335585860218621023225963187672383686646466495282076608008518928805427434803054656496247506256778933416487911972578635022671755329526878141593404681400810567684921091600432555691498259633826794822030120486561193975519478788279521246336885662345198573244723615343201756951944558659826034792053497560354024413422645062346382933393993839943910701889677932355179745522470445462583038533206084974501870992109461030029139255305409393431130237735461780563628314733335339158554453348498231756789541054169645211628376888955539841719993460009927039659274054650068387800893021758107",n,e);
    //cout<< "\nQUITAR FIRMA Y DECIFRAR:\n" <<yo.remove_sign("032092515398968786505576292456356794890096507878734221032091280880400378602806215614311960737291601615689529507208759995304297175459455159299972460100918129044273901652890451161424397963795459812731239744611819436890580650155136020268147547081799482430906800162441797231823366868140478510116566674010353401639219506236950226894322708847018803570025423374624498943134486121241835629384989735575719747283677596484483191550300420773654819271959148620893490107671846818016399382848945505660789299834209413307918343816258149370214684758901390201321981517928148689428547350900055723601170386388308830168381486457731593520490309503396532654248958783409495792561903351293342935594169348455859813667784795213702925185344705410863415814607329701715698235627776711328513217736257180718299902186894357456949951164342462018665630522174108821577511848357760491980555251688168059932283227043126396899362420358822241418020601169115042787789271227976448762447421378101542589164818709024427086815944107882016786185838204415121183966605284041915458122462894514106032330571949253543291457749167717096307537542038736371158150914654492313143267122082315563661036338619277070158416504167747001646218023028215000447541315880302898499273023546911431875820293810369693042895619592991900329705577079318216177087308800318968037751964632906406083841429107549571501294453380462871066781847595743489686533653224640459703917809012569586295943373593377316151541018755407591161514209559583085641384591584185676381487282322532236219053542595135631950819072381984028996733960656060839285463482350688713038749073342619187685274016172503940134219108796546768145420054798077020845905178230545920945524708654941531465424882078349279314050083801670543191632968355463696185223550961553669970191683311684636753877470903062439073135309523158430614080162446882035323509711247766074411764445724362",n,e);
    cout << "\nDECIFRAR SIN FIRMA: \n" << yo.decrypt("03671398177472644995112169178554603983247259738463084581781741939928933643632708647362905589169794777985521543967698666235021790077609511127797388365885750954596192821113235791506020400616627876778280254085606176239120946645064696033100935099149514483517554202206989538687329302263481534090062930134871430125773146185934971949936548933527274062882971555615735156016239745597935718613564717400140473384077540075708049205474103831296731533917497491057615374181637834731492411658421894174028025269631231873603174389440106141495654583673400033644802088737764459214518746518339394403327121086792220626260721764247605291331085168818494672467860312751048939434859257068505494250151851155830311428630292767711540813249484358669537029423282256674489304837394414111512944091374907022424296372869933155675087258090923809902932022769659300462453577694668439445150106013855671025600955361973887677854074164835617078018594943444535606244765848508245861498953855022568748238227598271438323623211473105704267293361805904686859338231877907918067062128792671711488036242502259205335401820728578180596028948976928610486262290340998301712414258552299548610373116657168571596323769415704798868477718244258878532107806143407852069851779580100746993937279531359515068110407866657964568511939359867485714580406185535000303043181032703534233180569603220057439459302239182942329989799681115255235647268493987484263841589431066718944271703689368016913407299413793910140392910348928151860627856901274191873792688147084161167341510744170424279041480533641650017430971953605621573752656754232352811003239782491732935270053184987531664806643894681666469429256216866153492897934006350013576726233508136021031123474904156483209131903692169627350252291441897185463878565219221578750098918197155872977279373644726586307485828626855149498393426984223609027055093680903566104296441237267212763713039296687284153285212492718622063125719480158303492987268357593668666828746410722777140811371577985453678679990681933026127003164815302945993334328319858425434586919453742864161768116608540061399967986455749394273226906345296986084216188863914563419338221289080959130062012123240642491903912866914402917732051226176484278924883242542056058928346174053917247401507425840269972288331975033215354290499524653258288482743940742648130277413402182680857013627043711624476752041371957803651673301622096770326938336647967413507260717524034403036119973488361275862868306757058049358646967429259019578019275112179002702126517128195597215254606126052137015707836788188505421917854307522001017072114659795584444903051415357013623299268643212312191160708734355398401386157236482759032663485773366796471733793141790557236219008923357907392171232025858566610510658979652623977651418586045878210930446429177682405515898720870527864676342326558110674260035017717787960231184712318896663853747620610100021605406306013533660342994378153532520686555499030697807826009041308972636562559799742386937767830683690925945697300070065097899379993483948020708355212428709288496727008501691524069004990719425512807305029150568130520723207582295092056507460503132056278886348548550932096564823010404649969298828901154401917043770756686516465932183266683618674639135168659346120031490793571357066543738983995067421101969749392688306280446571430639492350120310742972245832590510813389478940321681356399136476136115390099352363962511009020724197842549873954568173750637499329831687678975147119609772728119739890798483508097443686239389033824604873677763593641521396618706912038958828947293006931520615247480769198280091799939100055755813949689173576643730080534416088648493346963066961810874860566414160181340702325705481979361252795076210623675378680777302450803529282857960113391576995223308812177807677525360458171626386939150888016668598178058934086090548861128524605720377241429338209615969674728604326610812083075374781431149577905692261130683312480684587790752007958806137765373045831357796765522586870157683270347384937986662809072133437544394312174377762302866027024361651295594987475808371274208925704681748857772387346849645489437746170734634906875826964476699377153819254803227229975233349431972299541891890122559704553817116341326225498339429178399367958153652451756775113492659397423381345250038730976777371879863422807027576126344979244502988480280608604039877354659346943753749112226208100229325061627946660026569976679170949365179496165179100659304442029727652875100462463778500360142186642992154683607609499613092720505426084173536438699176735132742200764047601751306126875740595251286175892233949179910864705060763196906971402997591221352848657129032775941855655847194159772457176379103595386342044465237192914757901561851791330629577174153019871946244223508595637706348901509795579147845987430804658991368735008311635237027216695162322379301932686092013971754435230112193601649876834874687036388849859917474388253682980826364068162408461703433177068280950454265519077056632255620383519084791397176883001324813008097240297516193545227920133713077884682263807652779983396279192109413867548688666692009797530220991605526297148822374575668552752383810320580150962734442701787375760188192324600059475306729925833264781251172113351481825757965892013582584007637870868524900246107322623919147801528891591566017359348251011777462404067846523851140003099616890700625408159587263149666163930683406893502374006491605187397237299453220153468198448800104879702132910932981948573403357946073038765320165173805651991234775365354134324607171268965166432666280829511806893376609567754137194686385310397047736197740353083727212077873787525639919508813971077817958010476028698486111268693402871162397447358605058266516426059666060451259829823876375349249782140561556643356404404282155315746781891947615125585049944573390598041325162193539686616245440095897625833426799896809959313552188821085097869443838666717381359403142542043879265323542346372665503837054172128719062398898550413603062203886110852902575322719608104047464084202877923203241627739958529200331572517480332490035090956725662558255184169525880388789181643247813766957885226074037775550598773799660474677783446156960509787415992965196449132941711505143560157378401618122377471039036471631773948108862675555962623646466942160062462682532266746409388797779241964600158296481968182148176752211941072551496081033351817258099347755819270764342522236610212095423608379327772108992636034990538329608103361047963440014274025460524338439674295578358737359435576853748510841049987179591397357794846967520631652758269665436184712185056564073861654888535021773425920846773167218883924881218045478748099730200246616183301046652524485111942942390373786963670926762664122533403756728216699916281224747969312590707734930269252432437273378869778693490338593961074587014195903634867507984206931737042371433384210980202901980852969698511326022120019703092999361031603970604222845120110883943998682981592581006068154854552193411939564044583664412366870613538066670100937326470507603855947313276601952417389050791992355447826059682694313469398621117294188696145552436010207481170071067714299184590527384084012055059684709832021417870223427815518642215732933430539837790214333026259707518668408416904193363484047443495204038012681814306342768357297974930880640868100325673862809267538111655378683466716266148869447703235286612370661742725606974983586827874089959431755729617524625733210099528938324135795990562798877240269435109170191907370992924416101969669749873791222172216809246596790796524068549486218897290176416604212300769916861037802802967506773948755469885399979113758374462664960670044705246660370934065357874207887836562977812184973190784885556597770630915865115172943026837034036865200293099945008650345626847680162409473952676557766003890989646289182946450677424410354087382523837862904048621241869823916722238846929849698586189434321770681922429079298866731800165995118303156002140066796600152309083715509667883978993374978142632369913517509428396329017377292109167525715741357887438649503053966426098451737347726070711555812542225091250046777562909438870512511978352354194376413155178803973063855274192467250588195229005134885227847068618273906953749942274038026998856081287011962925710487455471683272643587879900157386586556499088796210485158180384884040845065276552769425587555506287658139554383289601031078108992447890018488397087367630880333342201667201584929147919309110060230767187875637787457266674949537348419235320960307857854734623308910617823662159373559373272332222616543284537640862153638435361592861983369181797019612830615933411478489133290213195126033864657736710857944287747066995907380999742055700179051522846053610738452122382186818610094629217702835324498782349025309787011896108706798704948226135022257950800254168000929022772194096584916498005639925960949461792710901984827646104788356990409679205168156415559897182851115355431114770468669056418766421350236824795854527781855355034353300183734882453412024414967599115572480683725630946733116091931758445436475406282009847957233796002531572980478775533632752913730602034973840246957471872609216985092902641963169430300133706433566897428664710129183484720658838205873458863021000053960575890679700488801858348567419260134218914251120169741283583604222530770177320366292950942021199109555755008296586810396684534017127030813629607855621900985901122519623435233520410729035338230028755231804601367478910077724680632311025925319231537723750007632012703243823233709517922812140161171653809823120981234617609708292630700470909756645347203954603065344533380879665447950382622074767829901362501699367810981324253968182272752328332404009300972703986914467109028584369939918801241504877780324014603801296487198610394591358231219840269044699622362803061349220014794748921083938268756244556713329508187072700639635298491543168124935237738129631215867613253641087211808207050699806398772873346021217998558883426466924682811732008141802343144576105731049428853702799761078042989024640896946968562896649853433570328512297473980504765912615432691463496995885047906744246475869950916335695828238024486397633602182244029344578493671900669363542228738666926245742049124394637707962599542036365444964785096651874304042710249776819295072388841627201927118486653268513657213258441147868704270310872402440414363668243866585715051207593442888886343565051654768804639866443131777038354543807541194511912144388676864286464511238185745700827799320258634946204889139039039995843160009003192408516471846366252180055638864043781081876432638150411647574702031020030481932524647421741660904855752715858933070628665617456012182421109030174820789894851007008687492143119377429950403815869916402162892027264832566173517451447291906356116693088377157328097889094594167236467669538576617929409990430676495631135120529123944326428194402801005077931621887523424145775269757447702913215415409661793784760358858739893240277887935287323855533236063016615726505389588206940886131309188243296473861268580504832436633015607036168367644099362511635084106028811921597984035578856416711968744800554887868183011786734415780584778795123319053804246555810065386962386039450667298983483738392608151591409569278976763136372242462860561201305352601698086212744009838042117261278311633927905126083708213337304473998212615013025936195184400572550584545997167289049773500008152832915591293458584764904814744099867711510379502637529967417525842588255967826368899534918165574722653809089098493041507813901530067476270319823520661833773320362498992313802844092513165043096920806602763246614787046438091623397683758086913383410674160071833737958628000756320841545912630259199858645790142329701827368818224056828801798847455882196286412246259840730992544540809300761339651405817270329957572018170294801295874445703196187869780937091977165867370403343190981351248743648423842423616345370150875849111839374335967063560731048617281083624944365250914606622197353639388489819981374730637859072798911988018019385111310323378294513045063249332350661422873911359427038071739167244476971237687020360781580632805782593892879601518904002800696839648677363077318020534702394921001031453320445567922923212102227835340842984810356970865633178859114970397807839500382397136917131179145679514999525214878823476124975621424122994253751186190190773872581335014349381329255539603536739548898127844475665856091016350711877027029474492636742530679959640713564212591970234457662801812898275636894136929448449754064271126440736208956835007320737663626237961258636865360449445062470182242422624924685685953539646350541749235020914512149234535004247163039394507189414931398297259303867098357218128137624178384283135980634436590310925469743365221745737902614399965080361561697283434307274595507499784271340377293243983382915156215522979291183510376923956935088760514840458544810238384728332301259779526625561159425741653780861276134584445537479384253118989240396443800154120305364246839194489305090036448946069700411144503334237595006157681754693657388148814474861475928546638166686420915610121867077720195973507364763347340587127601996654743505855927547485647402657808446026636041691745361447589964204794497727493997224026790027553383961957657618273291385835828053465440083316204886887553234294312048660881834493228057135680333348008547791068181027340422656579673660645374125486058970734146561306449055782867629561482231202184797400133999922710291715741612552583172292493893834112364280749618911683737117531658560647772105411918104178852215340005318405451160993676913819145297341505146004550420692410681223846516839368861587537283034198361932906391527017119753190353440624066465945315866430381823609693995043391764534297278868829749840951451324980226726510891207602114206264472318921821501725049930668344926884359239645300120315929813195426432069164915853484195534591641939505707446049576546513543648831821230434187082607828093191448859849641871734551483112851972360928292785506103102148786100351206794032345464959824772158659126303546831250441315812284427537498187556698739321024239977608995083407827202214206816483318478629832360369481807199616641302468581886783048796811920166562079213832579205395285235440886562613129973757590398970017231511057989907208107058017058218758672361120892166135154576327350258313738836931990004552954209788779038768047072808475766797232606464329000538791336041176549442861535587929645054998452375675467826585539146004968939252810527522183011573574009911310664678966340838144764808647014183748414126674294643629441985334001729015078400916891857255230344678709091926075911721843274413518052988611950998985205273751055897671783332322627732904086234625955801731209382375910319680695431508139850499242464603230925601989123419927530285517281161283675262693733570713568137426205099398714257445915714027981200925393175459574612321037820503287444006701257618353079602055205527803100691551797042124714972706612969414200521529493323505309492774281301002151336826961806430753600385298959307470480922312590973378737695583704977706667912525550076252827362156512113994084055757132176745415826652307366134225292527910404416867235403561510426958655963900201089017353974956928061194649191536945858658414175628633298560235114925300491458276436237576599129205492938889569446623115163047418858617211763094950450161132205405266485625966111130786192926524445340686421495051989308968430395187857059501001093985222757244203277504588777096087400217559885477487969133715841280241433945065471607893957066955919599874310985865460138755361439692085309203140918377047580909456299302186953548234560836106550000304918754260514848193040651071361683298682142449262539337310013325802591974534075889165368902192828548301942039801375035151446990984791123570143335842836696258637987092278449077509007967667640441477584843166244213888667290130821494376394577304177009007692811106966831465675293025632620732797052284871964022745457935673302299601683547913798156599987179811795165059581512428426217497753658968677135007558427174117336791101521816351691770908952957238039382690256775544399783849442674815815133864766422766205982864285722196502544933754348973718073129712523181709963520154617666688276605303414334578513956516665915907643071718606839864048882463409115409329485733792641680493480624916071821071414401884191731268531902653600179309176343157368884628450208808012657186635000619341453002751212844815695171903425075698359978355862231017875054625648406250668766381012942797516184166869498337757956504962465767772044518604247982978726931679741786589616670843592690177901499792096353252465942333728409880176207617608013358798736866356334369246544901579364014024449404343918377271152249784258043943212921728572178365178321279342510306171646449140603914006723148260974538087040514714427175896308706952478485064962290392701283623405611910073454725439959504276861637094906897453577353626397267359408662849738996993870963743541682128052053188601298007931856160044675677606751145949707344480794202195758640164414058936419950292064583428935911375028113801075796620170157389481004248871528456706344210549626795233824553476249762889680978674884869984159814328082139287509081028996544231741239422976153695062394244092980670652483457592163442968129074157912205941245356853590204281842559237120568878825418250604232388805195076994515060744288540593927820877277856613668627841402873581270733299956239731307541611811822885485132012802802239251284505765268049264195575241191491250345140356393545127075834641862518420998818477526244347174502730131079686950503020442038719588015607051238304166634042639990572930261176728249581648042432999643232201081230456750933091351708156772770605601819808697426620264827707400914617554104909085977771460291278588583605253428348925203567981277752299127057612534702359439306985777080407456001585461216783560306724239963497255070505631998026318638110636931514516581474386399042052310519167993637108356000521115364346313591059384085304281554856189304614725325484490559425938080886868242696814912415368275350782000403799787225586749268052125236578488411262073550447601214198058753121230704823009088480325528625753476413107827718564628332480591366321254560186623472233567201275133983960015065734563616356245990040771840283785802911581282074965956067513934123550230668486616922099549699472256060739865139836462211857502148188161560191902474264920127332185329498789072438148714166436060085397398267433795344218828599171613084203475779337849277429203288813305837974902101383872076827163488352115234222248790414504914009127490683076964038507325091028541538303110702683030388599963189602048947955323868925754499754598705770293801346155813327246532525267477094199572181662744694400911231369375290203081287356137878812530827263406156415476118810932567234000260169334400370548308017487401280967512939647548289767968260155539451686554482778082433408117731076712747890979515076392102238195406524642957179647984715836580085540433956427492247757705644991497116069378334693982217500925573052498355525262237855694908187932941360521410570566574554933733558971520936043128440609660716774769747209872098441984948558447618084976931628106180538462539342890050676642454466224518358931253704615207058859417110800310756305584099668697813074690541105460282730935308155891")<<endl;
    return 0;
}


